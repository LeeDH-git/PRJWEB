-- 게시판 테이블
CREATE TABLE TBL_BOARD
(
    BNO        NUMBER(10, 0),
    TITLE      VARCHAR2(200)  NOT NULL,
    CONTENT    VARCHAR2(2000) NOT NULL,
    WRITER     VARCHAR2(50)   NOT NULL,
    REGDATE    DATE DEFAULT SYSDATE,
    UPDATEDATE DATE DEFAULT SYSDATE
);

CREATE SEQUENCE SEQ_BOARD;

ALTER TABLE TBL_BOARD
    ADD CONSTRAINT PK_BOARD PRIMARY KEY (BNO);

ALTER TABLE TBL_BOARD
    ADD (REPLYCNT NUMBER DEFAULT 0);

UPDATE
    TBL_BOARD
SET REPLYCNT =(
    SELECT COUNT(RNO)
    FROM TBL_REPLY
    WHERE TBL_REPLY.BNO = TBL_BOARD.BNO);


-- 댓글
CREATE TABLE TBL_REPLY
(
    RNO        NUMBER(10, 0),
    BNO        NUMBER(10, 0)  NOT NULL,
    REPLY      VARCHAR2(1000) NOT NULL,
    REPLYER    VARCHAR2(50)   NOT NULL,
    REPLYDATE  DATE DEFAULT SYSDATE,
    UPDATEDATE DATE DEFAULT SYSDATE
);

CREATE SEQUENCE SEQ_REPLY;

ALTER TABLE TBL_REPLY
    ADD CONSTRAINT PK_REPLY PRIMARY KEY (RNO);

ALTER TABLE TBL_REPLY
    ADD CONSTRAINT FK_REPLY_BOARD FOREIGN KEY (BNO) REFERENCES TBL_BOARD (BNO);


--첨부파일 보관하는 테이블
CREATE TABLE TBL_ATTACH
(
    UUID       VARCHAR2(100) NOT NULL,
    UPLOADPATH VARCHAR2(200) NOT NULL,
    FILENAME   VARCHAR2(100) NOT NULL,
    FILETYPE   CHAR(1) DEFAULT 'I',
    BNO        NUMBER(10, 0)
);

ALTER TABLE TBL_ATTACH
    ADD CONSTRAINT PK_ATTACH PRIMARY KEY (UUID);

ALTER TABLE TBL_ATTACH
    ADD CONSTRAINT FK_BOARD_ATTACH FOREIGN KEY (BNO)
        REFERENCES TBL_BOARD (BNO);

